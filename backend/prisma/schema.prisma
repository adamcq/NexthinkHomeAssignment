// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  extensions = [vector]
}

model Article {
  id            String   @id @default(uuid())
  title         String
  content       String   @db.Text
  summary       String?  @db.Text
  url           String   @unique
  source        String   // 'reddit', 'arstechnica', 'techcrunch'
  sourceId      String   // Original ID from source
  author        String?
  publishedAt   DateTime
  fetchedAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  
  // Classification fields
  category      Category?
  categoryScore Float?   // Confidence score from LLM
  
  // Vector embedding for semantic search (1536 dimensions for text-embedding-004)
  embedding     Unsupported("vector(768)")?
  
  // Additional metadata
  metadata      Json?    // Source-specific data (score, comments, etc.)
  
  // Classification status
  classificationStatus ClassificationStatus @default(PENDING)

  @@index([source])
  @@index([publishedAt])
  @@index([category])
  @@index([fetchedAt])
  @@index([url])
  @@index([classificationStatus])
}

enum Category {
  CYBERSECURITY
  AI_EMERGING_TECH
  SOFTWARE_DEVELOPMENT
  HARDWARE_DEVICES
  TECH_INDUSTRY_BUSINESS
  OTHER
}

enum ClassificationStatus {
  PENDING
  COMPLETED
  FAILED
}
